(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/message/visitor"],{"0d47":function(t,e,a){},"2b8a":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(a("66fd")),n=r(a("6d8e")),o=r(a("88d3")),s=r(a("8212"));function r(t){return t&&t.__esModule?t:{default:t}}function l(t){return g(t)||c(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function g(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}var f=getApp(),d=i.default.extend({data:function(){return{title:"Hello",STATUS_BAR_HEIGHT:wx.STATUS_BAR_HEIGHT,DEFAULT_HEADER_HEIGHT:wx.DEFAULT_HEADER_HEIGHT,barconfig:{CustomBar:wx.STATUS_BAR_HEIGHT+wx.DEFAULT_HEADER_HEIGHT,StatusBar:wx.STATUS_BAR_HEIGHT,title:"最近来访",bgset:"bg-gradual-dred",tset:"bg-gradual-tred",hiddenTitle:2,isArrow:2},choseCheck:1,vicon:"https://sns-cdn.myxianxiaobao.com/sfximao/iconH.jpg",Iitemimg:"https://mzw-sns.oss-cn-beijing.aliyuncs.com/images/default/def_avatar_boy.png",Iitemimgw:"https://mzw-sns.oss-cn-beijing.aliyuncs.com/images/default/def_avatar_girl.png",newbar:"https://sns-cdn.myxianxiaobao.com/sfximao/newTag.png",param:{page:1,pagesize:10,current_page:0},paramV:{page:1,pagesize:10},loadConf:{loading:!1,current_page:1,last_page:1,len:0},loadConfV:{loading:!1,current_page:1,last_page:1,len:0},visitorTag:{},visitors:[],visitorsO:[],userInfo:{}}},onLoad:function(){this.getVisit(),this.getByVisit(),this.userInfo=f.globalData.userInfo},onReachBottom:function(){var t=1===this.choseCheck?this.paramV:this.param,e=t.current_page,a=t.last_page;t.page;t.loading||e==a||(t.page=e+1,1===this.choseCheck?this.getByVisit():this.getVisit())},methods:{choseFunc:function(t){this.choseCheck=t},setNewTag:function(){var t=o.default.getItem("visitors");t=t.length?JSON.parse(t):{},this.visitorsO.map(function(e){!t[e.id]&&(new Date).getTime()-new Date(1e3*e.time)<2592e5?(t[e.id]=!1,e.isNew=!0):(e.isNew=!1,t[e.id]||delete t[e.id])}),this.visitorTag=t,o.default.setItem("visitors",t)},getVisit:function(){var t=this,e=this.param;e.page===e.current_page||this.loadConf.loading||(this.loadConf.loading=!0,n.default.getVisitList(e).then(function(e){if(t.loadConf.loading=!1,1e4===e.code){var a=e.data;if(s.default.isEmpty(a))t.visitors=[];else{var i=a.last_page,n=a.current_page,o=a.total,r=a.data;t.loadConf.last_page=t.param.last_page=i||0,t.loadConf.current_page=t.param.current_page=n||0,t.loadConf.len=r&&r.length||0,t.param.total=o||0,t.visitors=[].concat(l(t.visitors),l(r))}}else s.default.showFail("数据获取失败")}))},getByVisit:function(){var t=this,e=this.paramV;e.page===e.current_page||this.loadConfV.loading||(this.loadConf.loading=!0,n.default.getBeVisitList(e).then(function(e){if(t.loadConfV.loading=!1,1e4===e.code){var a=e.data;if(s.default.isEmpty(a))t.visitorsO=[];else{var i=a.last_page,n=a.current_page,o=a.total,r=a.data;t.loadConfV.last_page=t.paramV.last_page=i||0,t.loadConfV.current_page=t.paramV.current_page=n||0,t.loadConfV.len=r&&r.length||0,t.paramV.total=o||0,t.visitorsO=[].concat(l(t.visitorsO),l(r)),t.visitorsO.length&&t.setNewTag()}}else s.default.showFail("数据获取失败")}))},goDetail:function(e){var a=e.currentTarget.dataset,i=a.key,n=a.id,s=a.mid;1===this.choseCheck&&(this.visitorTag[n]=!0,this.visitorsO[i].isNew=!1,this.$set(this.visitorsO,i,this.visitorsO[i]),o.default.setItem("visitors",this.visitorTag)),t.navigateTo({url:"/pages/userinfo/othersd?id=".concat(s)})}},filters:{timeForm:function(t){var e=new Date(1e3*t),a=[e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes()],i=a[3]>10?a[3]:"0"+a[3],n=a[0]+"-"+a[1]+"  "+a[2]+":"+i;return n}}});e.default=d}).call(this,a("6e42")["default"])},"40b8":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=(t._self._c,t.__map(t.visitorsO,function(e,a){var i=t._f("timeForm")(e.time);return{$orig:t.__get_orig(e),f0:i}})),i=t.__map(t.visitors,function(e,a){var i=t._f("timeForm")(e.time);return{$orig:t.__get_orig(e),f1:i}});t.$mp.data=Object.assign({},{$root:{l0:a,l1:i}})},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},"5cb9":function(t,e,a){"use strict";var i=a("0d47"),n=a.n(i);n.a},"95f2":function(t,e,a){"use strict";a.r(e);var i=a("40b8"),n=a("e75f");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("5cb9");var s=a("2877"),r=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},e75f:function(t,e,a){"use strict";a.r(e);var i=a("2b8a"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a}},[["591d","common/runtime","common/vendor"]]]);