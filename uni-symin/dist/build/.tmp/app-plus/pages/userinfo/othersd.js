(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/userinfo/othersd"],{"2c99":function(e,t,i){},"36ff":function(e,t,i){"use strict";i.r(t);var s=i("c418"),o=i.n(s);for(var n in s)"default"!==n&&function(e){i.d(t,e,function(){return s[e]})}(n);t["default"]=o.a},"6ec8":function(e,t,i){"use strict";i.r(t);var s=i("810c"),o=i("36ff");for(var n in o)"default"!==n&&function(e){i.d(t,e,function(){return o[e]})}(n);i("c40f");var a=i("2877"),r=Object(a["a"])(o["default"],s["a"],s["b"],!1,null,null,null);t["default"]=r.exports},"810c":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.tipShow=!1},e.e1=function(t){e.showchose=!0},e.e2=function(t){e.showchose=!1})},o=[];i.d(t,"a",function(){return s}),i.d(t,"b",function(){return o})},c40f:function(e,t,i){"use strict";var s=i("2c99"),o=i.n(s);o.a},c418:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(i("66fd")),o=r(i("8212")),n=r(i("6d8e")),a=i("2f62");function r(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,s)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(i,!0).forEach(function(t){h(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var f=getApp(),l=s.default.extend({data:function(){return{model:1,title:"Hello",STATUS_BAR_HEIGHT:wx.STATUS_BAR_HEIGHT,DEFAULT_HEADER_HEIGHT:wx.DEFAULT_HEADER_HEIGHT,barconfig:{CustomBar:wx.STATUS_BAR_HEIGHT+wx.DEFAULT_HEADER_HEIGHT,StatusBar:wx.STATUS_BAR_HEIGHT,title:"51约",bgset:"bg-gradual-dred",tset:"bg-gradual-tred",hiddenTitle:2,isArrow:2},isvideoRz:0,id:"",tipShow:!0,tipContent:"视频没有认证",tipStyle:{background:"#ffb400",color:"white"},items:[],swiperConf:{interval:5e3,duration:500,autoplay:!0,circular:!0,mode:"aspectFill"},uinfoDetail:[{key:"0",title:"邀约项目",icon:"",content:"希望一起吃饭",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!1},{key:"1",title:"身高",icon:"",content:"170cm",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!1},{key:"2",title:"职业",icon:"",content:"IT/互联网",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!1},{key:"3",title:"年收入",icon:"",content:"20~30w",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!1},{key:"4",title:"微信认证",icon:"",content:"",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!0},{key:"5",title:"手机",icon:"",content:"",arrow:!1,size:40,type:"text",url:"",isBorderR:!1,placeholder:"",isInput:!1,selfconf:!0,last:!0}],popmaskStyle:{"background-color":"rgba(0,0,0,.5)"},uinfoinputStyle:{"border-bottom":0},userInfo:{},userInfoDetail:{},selfTypes:[],selfPays:[],isWxrz:0,isSjrz:0,showChoosebox:!1,boxconfig:{key:0,model:1,title:"",content:"",btn:{ok:"确定",okcolor:"d-color-r",cancel:"取消",cancolor:"d-color-b"}},useKeys:5,checkType:"wx",copyStr:"",goVip:!1,isUseKey:0,goRz:!1,showchose:!1}},computed:u({},(0,a.mapGetters)({chatListaccount:"chatListaccount",chatListaccountsession:"chatListaccountsession",thischatList:"thischatList"})),onLoad:function(e){this.id=e.id||"",this.selfTypes=f.globalData.selfTypes,this.selfPays=f.globalData.selfPays,this.id&&this.getOtherInfo(this.id)},onShow:function(){this.userInfo=f.globalData.userInfo,this.locationInfo=f.globalData.locationInfo},onShareAppMessage:function(){var e=1===this.userInfoDetail.gender?"小哥哥":"小姐姐";return{title:"我发现一个有趣的".concat(e,"推荐给你"),path:"/pages/index/index?otherId="+this.userInfoDetail.memberID,imageUrl:this.userInfoDetail.header_url,success:function(e){}}},methods:{init:function(){var e=this;this.isWxrz=0,this.isSjrz=0,this.isvideoRz=0,this.userInfoDetail.nickname&&(this.barconfig.title=this.userInfoDetail.nickname),(this.userInfoDetail.video_permit||this.userInfoDetail.video_verfiy)&&(this.isvideoRz=1),0!==this.isvideoRz&&this.userInfo.video_url||(this.tipContent="对方未通过视频认证，谨防酒托，骗子"),this.userInfoDetail.picture=this.userInfoDetail.picture||[],this.userInfoDetail.height=this.userInfoDetail.height||170;var t=this.userInfoDetail.picture.filter(function(e){return e.src=e.value,e.src}),i=this.userInfoDetail.header_url?this.userInfoDetail.header_url:1===this.userInfoDetail.gender?f.globalData.Iitemimg:f.globalData.Iitemimgw,s={src:i};t.unshift(s),this.items=t;var n=this.selfTypes.filter(function(t){return t.value===1*e.userInfoDetail.objective}),a=this.selfPays.filter(function(t){return t.value===1*e.userInfoDetail.revenue});this.uinfoDetail[0].content=n&&n.length&&n[0].text||"希望一起吃饭",this.uinfoDetail[1].content=this.userInfoDetail.height+"cm",this.uinfoDetail[2].content=this.userInfoDetail.occupation_str||"IT/互联网",this.uinfoDetail[3].content=a&&a.length&&a[0].text||"20-30w",o.default.isEmpty(this.userInfoDetail.location)||(this.userInfoDetail.addr=this.userInfoDetail.location&&this.userInfoDetail.location.location,this.userInfoDetail.loginTime=o.default.ctDate(this.userInfoDetail.location&&1e3*this.userInfoDetail.location.heartbeat),this.userInfoDetail.distance=o.default.distance(this.locationInfo.latitude,this.locationInfo.longitude,this.userInfoDetail.location.latitude,this.userInfoDetail.location.longitude))},getOtherInfo:function(t){var i=this;o.default.showLoading("加载中..."),n.default.getOtherUser({member_id:t}).then(function(t){o.default.hideAll(),1e4===t.code&&(i.userInfoDetail=t.data,i.userInfoDetail.relationship&&!i.userInfoDetail.relationship.bh?i.init():i.messageFunc("你已被对方拉黑无法再访问Ta",function(){e.navigateBack()},1e3))})},checkVideo:function(t){var i=this;this.goRz=!1,this.goVip=!1,this.isUseKey=0;var s=this.userInfo&&this.userInfo.verfiy_list&&this.userInfo.verfiy_list.filter(function(e){return"video"===e.type});if(!s.length||0!==s[0].pass||this.userInfo.video_url)return s.length&&2===s[0].pass||!this.userInfo.video_url?(this.boxconfigfunc("本着公平原则，查看对方视频认证, 自己需要进行认证","去认证","取消",!0),void(this.goRz=!0)):this.id?void n.default.getOtherVideo({check_id:this.id}).then(function(t){switch(t.code){case 1e4:e.navigateTo({url:"/pages/tool/video?url=".concat(t.data,"&from=other&type=rz&header_url=").concat(i.userInfoDetail.header_url,"&memberID=").concat(i.userInfoDetail.memberID,"&nickname=").concat(i.userInfoDetail.nickname)});break;case 99995:i.boxconfigfunc(t.msg,"去认证","取消",!0),i.goRz=!0;break;case 99994:i.boxconfigfunc(t.msg,"好的","",!0);break;default:i.boxconfigfunc(t.msg,"好的","",!0);break}}):this.messageFunc("当前视频源出错了~");this.boxconfigfunc("你的视频正在审核中，请耐心等待","好的","",!0)},checkDetail:function(e){this.goRz=!1,this.goVip=!1,this.isUseKey=0;var t=o.default.getData(e),i=t.key,s="phone"===i?"手机":"微信",n="phone"===i?1:2,a=this.userInfo&&this.userInfo.rest_key_num||this.userInfoDetail&&this.userInfoDetail.my&&this.userInfoDetail.my.rest_key_num||0;return this.checkType=i,1===n&&this.userInfoDetail&&this.userInfoDetail.relationship&&1===this.userInfoDetail.relationship.phone_status?(this.isUseKey=1,void this.checkPhoneOrWechat()):2===n&&this.userInfoDetail&&this.userInfoDetail.relationship&&1===this.userInfoDetail.relationship.wechat_status?(this.isUseKey=2,void this.checkPhoneOrWechat()):void(0===this.userInfo.status?(this.boxconfigfunc("查看".concat(s,"需要升级会员"),"升级vip","取消",!0),this.goVip=!0):a<5&&this.userInfo.vip_id<4?(this.boxconfigfunc("查看".concat(s,"需要消耗钥匙").concat(this.useKeys," 您当前剩余钥匙").concat(a," 钥匙不足，需要升级VIP"),"升级vip","取消",!0),this.goVip=!0):this.userInfo.keys<5&&4===this.userInfo.vip_id?this.boxconfigfunc("钥匙已用完，你已经是最高等级VIP, 无法再升级, 明天再来查看Ta的".concat(s,"吧"),"好的","",!0):(this.boxconfigfunc("查看".concat(s,"需要消耗钥匙").concat(this.useKeys," 您当前剩余钥匙").concat(a),"使用","取消",!0),this.isUseKey="phone"===i?1:2))},goUrl:function(e){o.default.goUrl(e)},goYue:function(){if(this.goRz=!1,this.goVip=!1,this.isUseKey=0,this.userInfoDetail&&this.userInfoDetail.relationship&&this.userInfoDetail.relationship.relation)return this.createRelation();var e=this.userInfo&&this.userInfo.rest_key_num||this.userInfoDetail&&this.userInfoDetail.my&&this.userInfoDetail.my.rest_key_num||0;if(0===this.userInfo.status)return this.boxconfigfunc("此人当前人气过高，升级VIP才可以邀约TA","升级vip","取消",!0),void(this.goVip=!0);e>=1?(this.boxconfigfunc("您当前剩余钥匙".concat(e),"使用","取消",!0),this.isUseKey=3):e<1&&this.userInfo.vip_id<4?(this.boxconfigfunc("钥匙已用完，升级会员","升级vip","取消",!0),this.goVip=!0):e<1&&4===this.userInfo.vip_id&&this.boxconfigfunc("钥匙已用完，你已经是最高 等级VIP,无法再升级 请明天再联系Ta吧~","好的","取消",!0)},surefunc:function(t){if(this.copyStr.length)return this.copyFunc(this.copyStr),void(this.copyStr="");if(this.isUseKey)return this.useKey();if(this.goRz){this.goRz=!1;var i="/pages/tool/videorz";return this.userInfo.video_url.length||(i="/pages/regist/stepvideo"),e.navigateTo({url:i}),void(this.showChoosebox=!1)}if(this.goVip)return this.goVip=!1,e.navigateTo({url:"/pages/userinfo/vip"}),void(this.showChoosebox=!1);0===this.userInfo.status&&e.navigateTo({url:"/pages/userinfo/index",success:function(){this.showChoosebox=!1}}),this.showChoosebox=!1},cancelfunc:function(){this.boxconfigfunc()},useKey:function(){1!==this.isUseKey&&2!==this.isUseKey||this.checkPhoneOrWechat(),3===this.isUseKey&&this.createRelation()},createRelation:function(){var t=this;this.showChoosebox=!1;var i={accept_id:this.userInfoDetail.memberID};n.default.createRelation(i).then(function(i){if(1e4===i.code){t.messageFunc(i.msg),t.$store.dispatch("chatListaccount",t.userInfoDetail.yxID),t.$store.dispatch("chatListaccountsession","p2p"+t.userInfoDetail.yxID),t.RefreshtheDialogue();var s="我报名了你的".concat(t.uinfoDetail[0].content,"（项目）");1!=i.data.key&&(s="");var o="/pages/message/sessiondetails?chattype=".concat("p2p","&account=",t.userInfoDetail.yxID,"&avatar=").concat(t.userInfoDetail.header_url,"&nick=").concat(t.userInfoDetail.nickname,"&session=").concat("p2p"+t.userInfoDetail.yxID,"&uid=").concat(t.userInfoDetail.memberID,"&msg=").concat(s);e.navigateTo({url:o,success:function(e){f.$vm.getUserInfo(!0).then(function(e){t.userInfo=e})},fail:function(){},complete:function(){}})}else t.messageFunc(i.msg)})},RefreshtheDialogue:function(){var t=this;wx.NIMFUN.getHistoryMsgs({scene:"p2p",to:this.chatListaccount,limit:20,asc:!0,endTime:0,done:function(i,s){i?e.showToast({title:"请检查网络后重试",icon:"none",duration:3e3}):(console.log("当前用户：",t.chatListaccount,s.msgs," at pages\\userinfo\\othersd.vue:520"),t.thischatList[t.chatListaccountsession]=s.msgs,t.$store.dispatch("thischatList",t.thischatList))}})},checkPhoneOrWechat:function(){var e=this,t=this.isUseKey;if(this.isCopy=0,1!==t&&2!==t||!this.id)return this.messageFunc("当前用户信息错误~");n.default.checkPhoneOrWechat({check_type:t,check_id:this.id}).then(function(t){if(1e4===t.code){var i=(e.userInfoDetail.nickname||"千年老怪")+"的"+(1===e.isUseKey?"手机号":"微信");e.boxconfigfunc("".concat(t.data),"点击一键复制","",!0,i),e.copyStr=t.data||"",f.$vm.getUserInfo(!0).then(function(t){e.userInfo=t}),e.setUserInfoDetail(1===e.isUseKey?"phone_status":"wechat_status",1)}else e.boxconfigfunc(t.msg,"好的","",!0),e.isUseKey=0}).catch(function(t){e.showChoosebox=!1,e.messageFunc("当前用户信息错误~")})},setUserInfoDetail:function(e,t){this.userInfoDetail.relationship[e]=t},copyFunc:function(e){var t=this,i=1===this.isUseKey?"手机号":"微信";wx.setClipboardData({data:e,success:function(e){t.messageFunc("复制".concat(i,"成功，赶紧去添加Ta吧"))},complete:function(){t.showChoosebox=!1}})},boxconfigfunc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.boxconfig.title=o,this.boxconfig.content=e,this.boxconfig.btn.ok=t,this.boxconfig.btn.cancel=i,this.showChoosebox=s},messageFunc:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;wx.showToast({title:e||"当前信息处理错误",duration:1e3,icon:"none",success:function(){setTimeout(function(){t&&t()},i)}})},sendMsg:function(){var e=this,t={notice_id:this.userInfoDetail.memberID,notice_type:1};o.default.showLoading(),n.default.sendNotice(t).then(function(t){o.default.hideAll(),1e4===t.code?e.messageFunc("提醒成功"):e.messageFunc(t.msg)})},relationShip:function(){var e=this,t=this.userInfoDetail.relationship&&!this.userInfoDetail.relationship.h,i={target_id:this.userInfoDetail.memberID,relation_type:1,value:Number(t)};n.default.pullgRelatioasdasn(i).then(function(i){if(1e4===i.code){e.userInfoDetail.relationship.h=!e.userInfoDetail.relationship.h;var s="取消拉黑成功";t&&(s="拉黑成功"),e.messageFunc(s)}else e.messageFunc(i.msg)})},goDetail:function(t){var i=o.default.getData(t),s=i.url,n=i.uid;s&&(e.navigateTo({url:s+"?uid="+n}),this.showchose=!1)},goBack:function(){e.navigateBack({})}}});t.default=l}).call(this,i("6e42")["default"])}},[["3390","common/runtime","common/vendor"]]]);