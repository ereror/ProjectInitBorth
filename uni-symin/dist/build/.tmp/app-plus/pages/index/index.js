(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"175d":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},5912:function(t,e,a){},8069:function(t,e,a){"use strict";a.r(e);var i=a("ff2d"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},"928c":function(t,e,a){"use strict";var i=a("5912"),n=a.n(i);n.a},f75a:function(t,e,a){"use strict";a.r(e);var i=a("175d"),n=a("8069");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("928c");var r=a("2877"),s=Object(r["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=s.exports},ff2d:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(a("66fd")),n=u(a("8212")),o=u(a("82f8")),r=u(a("6d8e")),s=u(a("88d3")),l=a("2f62");function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return d(t)||f(t)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function d(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,i)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(a,!0).forEach(function(e){m(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function m(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var b=getApp(),v=i.default.extend({data:function(){return{title:"Hello",STATUS_BAR_HEIGHT:wx.STATUS_BAR_HEIGHT,DEFAULT_HEADER_HEIGHT:wx.DEFAULT_HEADER_HEIGHT,barconfig:{CustomBar:wx.STATUS_BAR_HEIGHT+wx.DEFAULT_HEADER_HEIGHT,StatusBar:wx.STATUS_BAR_HEIGHT,title:"51约",bgset:"bg-gradual-dred",tset:"bg-gradual-tred"},swiperConf:{interval:5e3,duration:500,autoplay:!0,circular:!0,mode:"aspectFill",model:1},vsxIcon:"../../static/images/sx.png",Iitemimg:"https://mzw-sns.oss-cn-beijing.aliyuncs.com/images/default/def_avatar_boy.png",Iitemimgw:"https://mzw-sns.oss-cn-beijing.aliyuncs.com/images/default/def_avatar_girl.png",vHot:"https://sns-cdn.myxianxiaobao.com/sfximao/v-hot.png",type:"",width:0,upload:"",param:{gender:0,sort:1,video:0,page:1,pagesize:10,last_page:1,total:0,current_page:0},initparam:{},loading:!1,loadConf:{loading:!1,current_page:1,last_page:1,len:0},vipIcon:[],userList:[],bannerList:[],selfTypesObj:{},isTopBar:!1,keyNow:0,vipItem:{},uploadResult:"",fromType:"",locationInfo:{latitude:"",longitude:""}}},computed:h({},(0,l.mapGetters)({tbarconfig:"tbarconfig"})),onLoad:function(t){t.height,t.width;var e=t.tempFilePath,a=t.type,i=t.otherId,n=t.fromType;this.initparam=Object.assign({},this.param),this.otherId=i||b.globalData.otherId,this.fromType=n;"upload"===a&&e&&(this.type="upload",this.uploadUrl=e,this.uploadFile(e)),!i||b.globalData.isNotRegist||n||this.goSmfunc(i)},onShow:function(){var e=this;this.userInfo=b.globalData.userInfo,this.vipIcon=b.globalData.vipIcon||[],this.locationInfo=b.globalData.locationInfo;var a=this.otherId||b.globalData.otherId,i=n.default.isEmpty(this.userInfo);b.globalData.isNotRegist?t.navigateTo({url:"/pages/index/begin?type=regist"}):!a||b.globalData.isNotRegist||this.fromType?b.globalData.loadFirst||(i?b.$vm.getUserInfo(!0).then(function(t){e.userInfo=t,e.init()}):this.init()):this.goSmfunc(a)},onPullDownRefresh:function(){this.param.current_page=0,this.param.page=1,this.userList=[],this.loading=!1,this.getMermbers(),this.getBannerList()},onReachBottom:function(){var t=this.loading,e=this.param,a=e.current_page,i=e.last_page;e.page;t||a==i||(this.param.page=a+1,this.loadConf.loading=!0,this.getMermbers())},methods:{init:function(){var t=this;this.selfTypes=b.globalData.selfTypes||s.default.getItem("selfTypes");var e=b.globalData.isBrush,a=s.default.getItem("queryParam");a.length&&(a=JSON.parse(a),a.age_min=a.ageVal[0]||18,a.age_max=a.ageVal[1]||70,a.height_min=a.heightVal[0]||150,a.height_max=a.heightVal[1]||220,a.recent=Number(a.recentR),a.objective=a.objective+"",(b.globalData.searchIndexResult||e)&&Object.assign(this.param,a));var i=b.globalData.vipItem;i&&i.length?this.initVip(i):b.$vm.getPlayList().then(function(e){t.initVip(e)}),this.selfTypes.map(function(e){t.selfTypesObj[e.id]=e.text}),this.getBannerList(),this.getMermbers()},goSmfunc:function(e){var a="",i=0,n=this.userInfo,o=n.height,r=n.birthday,s=n.objective,l=(n.occupation,n.revenue),u=n.gender,c=n.status,g=n.memberID;if(o&&r?s&&l?1===u&&0===c?a="/pages/message/join?from=index":i=1:a="/pages/regist/stepinfo":a="/pages/regist/stepuser",i){b.globalData.otherId="",this.otherId="";var f="/pages/userinfo/othersd?id=".concat(e);g&&e&&g===1*e&&(f="/pages/userinfo/detail"),t.navigateTo({url:f})}else t.reLaunch({url:a})},initVip:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.map(function(e){t.vipItem[e.id]=e.title.substr(0,2)})},getBannerList:function(){var t=this;r.default.getBannerList().then(function(e){1e4===e.code&&(t.bannerList=e.data||[],t.bannerList.map(function(t){t.src=t.picture_url}),b.globalData.bannerList=t.bannerList)})},goDetail:function(e){var a=e.currentTarget.dataset.id;t.navigateTo({url:"/pages/userinfo/othersd?id=".concat(a)})},getMermbers:function(){var t,e=this,a=b.globalData.isBrush;if(b.globalData.searchIndexResult||a){var i=this.param,o=i.gender,s=i.sort,l=i.video,u=i.page,g=i.current_page,f=i.pagesize,d=i.age_min,p=i.age_max,h=i.height_min,m=i.height_max,v=i.revenue,_=i.occupation,y=i.recent,I=i.objective;t={gender:o,sort:s,video:l,page:u,current_page:g,pagesize:f,age_min:d,age_max:p,height_min:h,height_max:m,revenue:v,occupation:_,recent:y,objective:I},t.objective=t.objective||0}else t=this.param;this.loading||(a&&(t.page=1,t.current_page=0,this.userList=[]),t.page!==t.current_page&&(this.loading=!0,r.default.getUserList(t).then(function(t){if(e.loading=!1,e.loadConf.loading=!1,1e4===t.code){var i=t.data,o=i.last_page,r=i.current_page,s=i.total,l=i.data;if(!l.length&&a)return b.globalData.searchIndexResult=!1,b.globalData.isBrush=!1,n.default.showFail("没有符合条件的用户，以后是系统为你推荐的用户",1e3),e.param=Object.assign({},e.initparam),void e.getMermbers();a&&l.length&&(b.globalData.isBrush=!1,b.globalData.searchIndexResult=!0),l.map(function(t){t.distance=n.default.distance(e.locationInfo.latitude,e.locationInfo.longitude,t.latitude,t.longitude)}),e.loadConf.last_page=e.param.last_page=o,e.loadConf.current_page=e.param.current_page=r,e.loadConf.len=l.length,e.param.total=s,e.userList=[].concat(c(e.userList),c(l))}else n.default.showFail("数据获取失败")}).catch(function(t){e.loading=!1,e.loadConf.loading=!1})))},swiperchange:function(t){var e=t.detail.key;this.keyNow=e},goUrl:n.default.throttle(function(t){n.default.goUrl(t)}),checkResult:function(){"fail"===this.upload&&(this.type="upload",this.upload="",this.uploadFile(this.uploadUrl))},uploadFile:function(t){var e=this,a=this;this.upload="";var i=o.default.uploadFileProgress({filePath:t,formData:{uploadtype:"file"},success:function(t){var e=t.data;a.upload="success",a.saveUser(e.url),setTimeout(function(){a.uploadResult="complete"},1e3)},fail:function(t){a.width=100,a.upload="fail"},complete:function(){}});i.onProgressUpdate(function(t){e.width=t.progress})},saveUser:function(e){var a={id:this.userInfo.memberID,video_url:e};r.default.saveData(a).then(function(e){1e4===e.code&&t.$emit("getUserInfo",{msg:"更新用户信息"})})}}});e.default=v}).call(this,a("6e42")["default"])}},[["d537","common/runtime","common/vendor"]]]);